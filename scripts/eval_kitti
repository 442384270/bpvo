#!/bin/bash

descriptor="bitplanes"

for s in {0..10}; do
  conf="
DataSet = kitti
DataSetRootDirectory = ~/data/kitti/dataset
SequenceNumber = ${s}

numPyramidLevels = -1
Descriptor = ${descriptor}

parameterTolerance = 1e-6
functionTolerance = 1e-5

verbosity = Silent

lossFunction = Huber
minSaliency = 0.1
nonMaxSuppRadius = 1

minTranslationMagToKeyFrame = 0.25
minRotationMagToKeyFrame = 2.0
maxFractionOfGoodPointsToKeyFrame = 0.6

maxIterations = 200
relaxTolerancesForCoarseLevels = 1

StereoAlgorithm = BlockMatching
SADWindowSize = 9
minDisparity = 0
numberOfDisparities = 128
trySmallerWindows = 1
ScaleBy = 1

minValidDisparity = 1
maxValidDisparity = 128

maxTestLevel = 0

"

conf_fn=$(mktemp)
echo "$conf" > $conf_fn

prefix="kitti_${descriptor}_seq_${s}_dense_no_kf"
./bin/vo -c $conf_fn -o $prefix -n -1 --store-timing --store-iterations -x

done
